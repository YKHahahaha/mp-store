{"version":3,"file":"mpstore.esm.js","sources":["../src/utils.js","../src/mixin.js","../src/diff.js","../src/middleware.js","../src/update.js","../src/store.js","../src/index.js"],"sourcesContent":["export const warn = message => {\n  throw new Error(`\\n\\n[MpStore warn]: ${message}\\n\\n`)\n}\n\nexport const assert = (condition, message) => {\n  if (condition) warn(message)\n}\n\nexport const mergeState = (oldState, newState) => {\n  return Object.freeze({ ...oldState, ...newState })\n}\n\nexport const isEmptyObject = obj => {\n  for (const key in obj){\n    return false\n  }\n  return true\n}\n\nexport const remove = (list, item) => {\n  const index = list.indexOf(item)\n  if (index > -1) {\n    list.splice(index, 1)\n  }\n}\n\nexport const callHook = (hooks, name, args) => {\n  if (hooks && typeof hooks[name] === 'function') {\n    return hooks[name].apply(hooks, args)\n  }\n}\n\nexport const createWraper = (target, before, after) => {\n  return function (...args) {\n    let result\n\n    if (typeof before === 'function') {\n      before.apply(this, args)\n    }\n\n    if (typeof target === 'function') {\n      result = target.apply(this, args)\n    }\n\n    if (typeof after === 'function') {\n      after.apply(this, args)\n    }\n\n    return result\n  }\n}\n\nexport const mapObject = (obj, fn) => {\n  const desObject = {}\n  for (const key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      desObject[key] = fn(obj[key])\n    }\n  }\n  return desObject\n}\n\nexport const isPlainObject = obj => {\n  if (typeof obj !== 'object' || obj === null) return false\n\n  const proto = Object.getPrototypeOf(obj)\n  if (proto === null) return true\n\n  let baseProto = proto\n  while (Object.getPrototypeOf(baseProto) !== null) {\n    baseProto = Object.getPrototypeOf(baseProto)\n  }\n  return proto === baseProto\n}","import { assert } from './utils'\n\nexport default function (inject) {\n  const expandMethods = Object.create(null)\n\n  if (typeof inject === 'function') {\n    const callback = (name, fn) => {\n      assert(\n        typeof name !== 'string' || typeof fn !== 'functin',\n        `Mixed callback parameters are illegal.`,\n      )\n\n      assert(\n        name in expandMethods,\n        `The \"${name}\" is exist,`, +\n          `Please don't repeat mixin.`\n      )\n\n      expandMethods.name = fn\n    }\n\n    inject(callback)\n  }\n  return expandMethods\n}","export const ADD = 1\nexport const REMOVE = 2\nexport const REPLACE = 3\n\nfunction Patch (type, path, value, leftValue) {\n  this.type = type\n  this.path = path\n  this.value = value\n  this.leftValue = leftValue\n}\n\n// compare left and right values\nfunction diffValues (left, right, path, patchs) {\n  // filter functin and null\n  if (typeof left === 'function' || left === null) {\n    patchs.push(new Patch(REPLACE, path, right, left))\n  } else if (Array.isArray(left)) {\n    // diff array\n    if (Array.isArray(right)) {\n      walkArray(left, right, path, patchs)\n    } else {\n      patchs.push(new Patch(REPLACE, path, right, left))\n    }\n  } else if (typeof left === 'object') {\n    // diff object\n    if (\n        right !== null &&\n        typeof right === 'object' &&\n        !Array.isArray(right)\n    ) {\n      // filter Date object\n      if (left instanceof Date || right instanceof Date) {\n        patchs.push(new Patch(REPLACE, path, right, left))\n      } else {\n        walkObject(left, right, path, patchs)\n      }\n    } else {\n      patchs.push(new Patch(REPLACE, path, right, left))\n    }\n  } else {\n    patchs.push(new Patch(REPLACE, path, right, left))\n  }\n}\n\nfunction walkArray (a, b, base, patchs) {\n  if (a.length <= b.length) {\n    let len = a.length\n    while (--len >= 0) {\n      if (a[len] !== b[len]) {\n        const path = `${base}[${len}]`\n        diffValues(a[len], b[len], path, patchs)\n      }\n    }\n  \n    if (b.length > a.length) {\n      len = b.length\n      while (--len >= a.length) {\n        const path = `${base}[${len}]`\n        patchs.push(new Patch(ADD, path, b[len], a[len]))\n      }\n    }\n  } else {\n    // if new list less than old list,\n    // no need diff, direct replac is fine.\n    patchs.push(new Patch(REPLACE, base, b, a))\n  }\n}\n\nfunction walkObject (a, b, base, patchs) {\n  // walk left object\n  for (const key in a) {\n    // current path\n    const path = `${base}['${key}']`\n\n    if (!(key in b)) {\n      patchs.push(new Patch(REMOVE, path, null, a[key]))\n    } else if (a[key] !== b[key]) {\n      diffValues(a[key], b[key], path, patchs)\n\n      // don't use `delete` statement,\n      // will destroy the stability of the `object` structure\n      // delete b[key]\n    }\n  }\n\n  // walk right object\n  for (const key in b) {\n    if (!(key in a)) {\n      const path = `${base}[${key}]`\n      patchs.push(new Patch(ADD, path, b[key], null))\n    }\n  }\n}\n\n// root `a` and root `b` is an object\nexport const diff = (a, b, basePath) => {\n  const patchs = []\n  walkObject(a, b, basePath, patchs)\n  return patchs\n}\n\nconst REG = /[^\\[]+(?=\\])/g\nconst filter = key => key.replace(/'/g, '')\n\n// return target object\nconst separatePath = (obj, path) => {\n  const keys = path.match(REG)\n\n  if (keys) {\n    let i = -1\n    let key = null\n    let target = obj\n    let prevTarget = null\n\n    while (i++ < keys.length - 2) {\n      prevTarget = target\n      key = filter(keys[i])\n      target = target[key]\n    }\n\n    return [target, key, prevTarget, filter(keys[keys.length -1])]\n  }\n}\n\nexport const restore = (obj, patchs) => {\n  let len = patchs.length\n  const delEmptys = new Map()\n\n  while (--len >= 0) {\n    const { type, path, leftValue } = patchs[len]\n    const parseItem = separatePath(obj, path)\n\n    if (parseItem) {\n      const [target, key, prevTarget, lastKey] = parseItem\n\n      // reverse recovery\n      switch (type) {\n        case REMOVE :\n          target[lastKey] = leftValue\n          break\n        case REPLACE :\n          target[lastKey] = leftValue\n          break\n        case ADD :\n          if (Array.isArray(target) && target === prevTarget[key]) {\n            delEmptys.set(target, { key, prevTarget })\n          }\n          delete target[lastKey]\n          break\n      }\n    }\n  }\n\n  delEmptys.forEach(({ key, prevTarget }, target) => {\n    const clone = new target.constructor()\n    // filter empty item\n    target.forEach(item => clone.push(item))\n    prevTarget[key] = clone\n  })\n\n  return obj\n}","import { warn } from './utils'\n\nexport const COMMONACTION = '*'\n\nconst match = (layer, action) => {\n  if (action === COMMONACTION) return true\n  return action === layer.action\n}\n\nconst handleLayer = (fn, action, store, payload, next) => {\n  try {\n    fn.call(store, payload, next)\n  } catch (err) {\n    const hooks = store.hooks\n\n    // if the error hook exist, don't throw error\n    if (hooks && typeof hooks['middlewareError'] === 'function') {\n      hooks['middlewareError'](action, payload, err)\n    } else {\n      warn(`${err}\\n\\n   --- from [${action}] action.`)\n    }\n  }\n}\n\n// deal with all middleware\nexport default class Middleware {\n  constructor (store) {\n    this.stack = []\n    this.store = store\n  }\n\n  use (action, fn) {\n    this.stack.push({ fn, action })\n  }\n\n  remove (action, fn) {\n    const idx = this.stack.findIndex(layer => {\n      return layer.fn === fn && layer.action === action\n    })\n\n    if (idx > -1) {\n      this.stack.splice(idx, 1)\n    }\n  }\n\n  process (action, payload) {\n    if (this.stack.length > 0) {\n      let idx = 0\n      const next = prevPayload => {\n        let layer = this.stack[idx]\n\n        while (layer && !match(layer, action)) {\n          layer = this.stack[++idx]\n        }\n\n        if (layer) {\n          // put `try catch` in a separate function,\n          // avoid the entire function not being optimized.\n          handleLayer(layer.fn, action, this.store, prevPayload, next)\n        }\n\n        idx++\n      }\n\n      next(payload)\n    }\n  }\n}","import { diff } from './diff'\nimport { callHook } from './utils'\nimport { GLOBALWORD } from './store'\n\nexport const applyPatchs = (component, patchs) => {\n  const desObject = {}\n\n  for (let i = 0, len = patchs.length; i < len; i++) {\n    const { value, path } = patchs[i]\n    desObject[path] = value\n  }\n\n  component.setData(desObject)\n}\n\n// update page and component\nexport const updateComponents = (deps, hooks) => {\n  for (let i = 0, len = deps.length; i < len; i++) {\n    const { isPage, component, didUpdate, willUpdate, createState } = deps[i]\n\n    if (component.data[GLOBALWORD]) {\n      const newPartialState = createState()\n\n      // the `willUpdate` function will optimize component\n      if (typeof willUpdate === 'function') {\n        if (willUpdate(newPartialState) === false) {\n          continue\n        }\n      }\n\n      // the base path is `GLOBALWORD`\n      // example: this.setData({ 'global.xx': xx })\n      const patchs = diff(component.data[GLOBALWORD], newPartialState, GLOBALWORD)\n\n      if (patchs.length > 0) {\n        // call global hooks\n        const params = [component, newPartialState, patchs, isPage]\n        if (callHook(hooks, 'willUpdate', params) === false) {\n          continue\n        }\n\n        // update component\n        applyPatchs(component, patchs)\n\n        if (typeof didUpdate === 'function') {\n          didUpdate(newPartialState)\n        }\n        callHook(hooks, 'didUpdate', [component, newPartialState, isPage])\n      }\n    }\n  }\n}","import {\n  warn,\n  assert,\n  remove,\n  callHook,\n  mapObject,\n  mergeState,\n  createWraper,\n  isPlainObject,\n} from './utils'\nimport { diff } from './diff'\nimport Middleware, { COMMONACTION } from './middleware'\nimport { applyPatchs, updateComponents } from './update'\n\n// global state namespace\nexport let GLOBALWORD = 'global'\n\nconst assertReducer = (state, action, reducer) => {\n  const { setter, partialState } = reducer\n\n  assert(\n    !('partialState' in reducer),\n    `You must defined [partialState].` + \n      `\\n\\n --- from [${action}] action.`,\n  )\n\n  assert(\n    !partialState || typeof partialState !== 'object',\n    `The [partialState] must be an object.` +\n      `\\n\\n --- from [${action}] action.`,\n  )\n\n  for (const key in partialState) {\n    assert(\n      state.hasOwnProperty(key),\n      `The [${key}] already exists in global state, ` +\n        `Please don't repeat defined. \\n\\n --- from [${action}] action.`\n    )\n  }\n\n  if (typeof setter !== 'function') {\n    reducer.setter = () => {\n      throw `Can\\'t changed [${action}] action value. Have you defined a setter?`\n    }\n  }\n  return reducer\n}\n\nexport default class Store {\n  constructor (hooks) {\n    this.state = {}\n    this.hooks = hooks\n    this.reducers = []\n    this.depComponents = []\n    this.isDispatching = false\n    this.middleware = new Middleware(this)\n  }\n\n  add (action, reducer) {\n    assert(\n      this.reducers.find(v => v.action === action),\n      `Can't repeat defined [${action}] action.`,\n    )\n\n    const { partialState } = assertReducer(this.state, action, reducer)\n\n    reducer.action = action\n    this.reducers.push(reducer)\n    this.state = mergeState(this.state, partialState)\n  }\n\n  dispatch (action, payload) {\n    const { reducers, isDispatching } = this\n\n    // if we in call dispatch process,\n    // we don't allow call dispacth again.\n    assert(\n      isDispatching,\n      'It is not allowed to call \"dispatch\" during dispatch execution.' +\n        `\\n\\n   --- from [${action}] action.`\n    )\n\n    const reducer = reducers.find(v => v.action === action)\n\n    assert(\n      !reducer,\n      `The \"${action}\" does not exist. ` +\n        'Maybe you have not defined.'\n    )\n\n    const fn = prevPayload => {\n      this.isDispatching = true\n\n      // the current function is called only once\n      this.middleware.remove(action, fn)\n      \n      try {\n        const newPartialState = reducer.setter(this.state, prevPayload)\n        this.state = mergeState(this.state, newPartialState)\n      } catch (error) {\n        // if call setter function throw an error,\n        // the `isDispatching` need restore.\n        this.isDispatching = false\n        throw error\n      }\n      \n      // update components\n      updateComponents(this.depComponents, this.hooks)\n\n      this.isDispatching = false\n    }\n\n    // add setter fn to middleware\n    this.middleware.use(action, fn)\n\n    // call all middleware\n    this.middleware.process(action, payload)\n  }\n\n  // add middleware\n  use (action, fn) {\n    if (typeof action !== 'string') {\n      fn = action\n      action = COMMONACTION\n    }\n\n    this.middleware.use(action, fn)\n    return () => this.middleware.remove(action, fn)\n  }\n\n  // allow change `GLOBALWORD`.\n  setNamespace (key) {\n    if (typeof key === 'string') {\n      GLOBALWORD = key\n    }\n  }\n\n  // insert method\n  _rewirteCfgAndAddDep (config, isPage) {\n    let createState = null\n    const store = this\n    const { data, storeConfig = {} } = config\n    const { didUpdate, willUpdate, defineReducer, usedGlobalState } = storeConfig\n\n    // this is a uitl method,\n    // allow craete reducer in the page or component.\n    if (typeof defineReducer === 'function') {\n      defineReducer.call(store, store)\n      delete config.storeConfig\n    }\n\n    // get the global state words used\n    if (typeof usedGlobalState === 'function') {\n      const defineObject = usedGlobalState.call(store, store)\n\n      assert(\n        !isPlainObject(defineObject),\n        '[usedGlobalState] must return a plain object,' +\n          `but now is return a [${typeof defineObject}]`,\n      )\n\n      createState = () => mapObject(defineObject, fn => fn(this.state))\n    }\n\n    // get state used by the current component\n    if (createState !== null) {\n      const usedState = createState()\n      if (isPlainObject(usedState)) {\n        data \n          ? data[GLOBALWORD] = usedState\n          : config.data = { [GLOBALWORD]: usedState }\n      }\n    }\n\n    const addDep = component => {\n      const shouldAdd = callHook(this.hooks, 'addDep', [component, isPage])\n\n      // if no used global state word,\n      // no need to add dependencies.\n      if (shouldAdd !== false && createState !== null) {\n        if (isPlainObject(component.data[GLOBALWORD])) {\n          // add component to depComponents\n          this.depComponents.push({\n            isPage,\n            component,\n            didUpdate,\n            willUpdate,\n            createState,\n          })\n\n          // if the global state is changed, need update component\n          const patchs = diff(component.data[GLOBALWORD], createState())\n          if (patchs.length > 0) {\n            applyPatchs(component, patchs)\n          }\n        }\n      }\n    }\n\n    if (isPage) {\n      config.onLoad = createWraper(\n        config.onLoad,\n        function () {\n          addDep(this)\n          // rigister store to component within\n          this.store = store\n        },\n      )\n      \n      config.onUnload = createWraper(\n        config.onLoad,\n        null,\n        function () {\n          // clear cache\n          this.store = null\n          remove(store.depComponents, this)\n        },\n      )\n    } else {\n      // Component\n      config.lifetimes = config.lifetimes || {}\n      const get = name => config[name] || config.lifetimes[name]\n      const set = (name, fn) => config[name] = config.lifetimes[name] = fn\n\n      set('attached', createWraper(\n        get('attached'),\n        function () {\n          addDep(this)\n          this.store = store\n        },\n      ))\n\n      set('detached', createWraper(\n        get('detached'),\n        null,\n        function () {\n          this.store = null\n          remove(store.depComponents, this)\n        },\n      ))\n    }\n  }\n}","import mixin from './mixin'\nimport Store from './store'\nexport { restore } from './diff'\nimport { callHook, createWraper, isEmptyObject } from './utils'\n\nconst nativePage = Page\nconst nativeComponent = Component\n\nconst expandConfig = (config, expandMethods, isPage) => {\n  if (!isEmptyObject(expandMethods)) {\n    if (isPage) {\n      Object.assign(config, expandMethods)\n    } else {\n      if (config.methods) {\n        Object.assign(config.methods, expandMethods)\n      } else {\n        config.methods = { ...expandMethods }\n      }\n    }\n  }\n}\n\nexport default function (mixinInject, hooks) {\n  const store = new Store(hooks)\n  const expandMethods = mixin(mixinInject)\n\n  // we can rewirte Page and Component function\n  // this will be better compatible with previous project\n  Page = createWraper(\n    nativePage,\n    function (config) {\n      // we allow add additional config attributes\n      callHook(hooks, 'createBefore', [true, config])\n\n      expandConfig(config, expandMethods, true)\n    \n      // the store will record all page and component\n      // when global state changed, the dependent components will be update\n      store._rewirteCfgAndAddDep(config, true)\n    },\n  )\n\n  Component = createWraper(\n    nativeComponent,\n    function (config) {\n      callHook(hooks, 'createBefore', [false, config])\n\n      expandConfig(config, expandMethods, false)\n      store._rewirteCfgAndAddDep(config, false)\n    },\n  )\n\n  return store\n}"],"names":["warn","message","Error","assert","condition","mergeState","oldState","newState","Object","freeze","isEmptyObject","obj","key","remove","list","item","index","indexOf","splice","callHook","hooks","name","args","apply","createWraper","target","before","after","result","mapObject","fn","desObject","hasOwnProperty","isPlainObject","proto","getPrototypeOf","baseProto","inject","expandMethods","create","callback","ADD","REMOVE","REPLACE","Patch","type","path","value","leftValue","diffValues","left","right","patchs","push","Array","isArray","walkArray","Date","walkObject","a","b","base","length","len","diff","basePath","REG","filter","replace","separatePath","keys","match","i","prevTarget","restore","delEmptys","Map","parseItem","lastKey","set","forEach","clone","constructor","COMMONACTION","layer","action","handleLayer","store","payload","next","call","err","Middleware","stack","use","idx","findIndex","process","prevPayload","applyPatchs","component","setData","updateComponents","deps","isPage","didUpdate","willUpdate","createState","data","GLOBALWORD","newPartialState","params","assertReducer","state","reducer","setter","partialState","Store","reducers","depComponents","isDispatching","middleware","add","find","v","dispatch","error","setNamespace","_rewirteCfgAndAddDep","config","storeConfig","defineReducer","usedGlobalState","defineObject","usedState","addDep","shouldAdd","onLoad","onUnload","lifetimes","get","nativePage","Page","nativeComponent","Component","expandConfig","assign","methods","mixinInject","mixin"],"mappings":"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"}